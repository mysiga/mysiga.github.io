<!DOCTYPE html>
<html lang="cn">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Wilson" />


    
    


<meta name="description" content="每周分享博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Wilson">
<meta property="og:url" content="mysiga.cn/index.html">
<meta property="og:site_name" content="Wilson">
<meta property="og:description" content="每周分享博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wilson">
<meta name="twitter:description" content="每周分享博客">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Wilson" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Wilson</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Wilson</a></h1>
        </hgroup>

        
        <p class="header-subtitle">爱折腾的技术男</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tablayout/">tablayout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/同步异步/">同步异步</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/坑/">坑</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发效率/">开发效率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/效率/">效率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/研发杂谈/">研发杂谈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动组周分享/">移动组周分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程/">线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网站/">网站</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Wilson</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Wilson</a></h1>
            </hgroup>
            
            <p class="header-subtitle">爱折腾的技术男</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-单元测试" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/15/单元测试/" class="article-date">
      <time datetime="2016-07-15T15:30:00.000Z" itemprop="datePublished">2016-07-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/15/单元测试/">单元测试</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li>注：基于<a href="http://chriszou.com/" target="_blank" rel="external">小创</a>分享的总结</li>
</ul>
<h4 id="明确概念"><a href="#明确概念" class="headerlink" title="明确概念"></a>明确概念</h4><ul>
<li>单元测试 or 集成测试：</li>
<li>单元测试在<a href="https://zh.wikipedia.org/wiki/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95" target="_blank" rel="external">维基百科</a>是这样定义的</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">单元测试（英语：<span class="keyword">Unit</span> Testing）又称为模块测试, 是针对程序模块（软件设计的最小单位）来进行正确性检验的测试工作。程序单元是应用的最小可测试部件。在过程化编程中，一个单元就是单个程序、函数、过程等；对于面向对象编程，最小单元就是方法，包括基类（超类）、抽象类、或者派生类（子类）中的方法。</div></pre></td></tr></table></figure>
<p>集成测试在<a href="https://zh.wikipedia.org/wiki/%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95" target="_blank" rel="external">维基百科</a>的定义<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">集成测试,整合测试又称组装测试，即对程序模块采用一次性或增殖方式组装起来，对系统的接口进行正确性检验的测试工作。整合测试一般在单元测试之后、系统测试之前进行。实践表明，有时模块虽然可以单独工作，但是并不能保证组装起来也可以同时工作</div></pre></td></tr></table></figure></p>
<p>有没有理解?那我们在借鉴下《单元测试的艺术》对单元测试和集成测试的定义：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">一个单元测试时一段自动化的代码，这段代码调用被测试的工作单元，之后对这个单元的单个最终结果的某些假设进行检验。单元测试几乎都是用单元测试框架编写。单元测试容易编写，能快速运行。单元测试可靠，可读，并且可维护。只要产品代码不发生变化，单元测试的结果是稳定的。</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">集成测试是对一个工作单元进行的测试，这个测试对被测试的工作单元没有完全控制，并使用该单元的一个或者多个真实依赖物，例如时间，网络，数据库，线程或随机数产生器等。</div></pre></td></tr></table></figure>
<p>现在应该了解吧，没有了解不要紧，我们再通过他们关系比对<br> 那单元测试和集成测试的关系是怎么样了？<br> <img src="http://7xod3k.com1.z0.glb.clouddn.com/qtijqabixtlihxsuujkwnlzelrqnwqnz" alt="单元测试和集成测试"><br> <a href="http://chriszou.com/2016/04/13/android-unit-testing-start-from-what.html" target="_blank" rel="external">链接</a></p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li>保证代码质量，防止bug或尽早发现bug的作用</li>
<li>改善代码的设计，节约开发调试时间</li>
<li>大大减少重构中手动验证正确性的时间。</li>
<li><p>在写单元测试的时候也能发现方法乃至系统结构设计的不合理</p>
</li>
<li><p>前面都是官方文字，现在讲点实在的。单元测试就是测试方法，方法我们又分为两种</p>
<ul>
<li>有返回值方法</li>
<li>无返回值方法</li>
</ul>
</li>
<li><p>有返回值方法，我们测试这个方法直接通过测试这个方法返回的值是否跟你预期一样。我们就以一个登陆的demo来解析吧</p>
<ul>
<li><p>环境</p>
<ul>
<li>IDE:Android Studio</li>
<li><p>Java测试库:junit，在build.gradle配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">test</span>Compile <span class="string">'junit:junit:4.12'</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-784a1cb7911ccafa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="目录结构"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleUnitTest</span> </span>&#123;</div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addition_isCorrect</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        assertEquals(<span class="number">4</span>, <span class="number">2</span> + <span class="number">2</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个是新近一个Android新建的项目，生成的单元测试，直接通过点击方法的运行就能看的结果了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-6287758ce0be0d42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="代码"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-82ee776821842f50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="运行结果"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-d33f48cff28cc3a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="代码"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-a0b2da8b0c4418b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="错误运行结果"><br>实际开发中我们也是通过get()获取指定值比较这个应该比较容易理解。重点就是第二个了</p>
<ul>
<li>无返回值方法，我们只能通过方法内某个对象的方法是否被调用并且调用参数一样。这里就要用到mock，mock其实就是虚拟一个对象，然后根据这个对象方法判断是否被调用，mock目前比较成熟的框架是Mockito，所有我们这里要引用Mockito框架</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dependencies</span> &#123;    </div><div class="line"><span class="keyword">compile</span> <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])    </div><div class="line">androidTestCompile(<span class="string">'com.android.support.test.espresso:espresso-core:2.2.2'</span>, </div><div class="line">&#123;        </div><div class="line">  <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'com.android.support'</span>, module: <span class="string">'support-annotations'</span>    &#125;)</div><div class="line">   </div><div class="line"> <span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:23.4.0'</span>    </div><div class="line"><span class="keyword">compile</span> <span class="string">'com.android.support.constraint:constraint-layout:1.0.0-alpha4'</span>    </div><div class="line"><span class="comment">//以下测试框架    </span></div><div class="line">testCompile <span class="string">"junit:junit:4.12"</span>    </div><div class="line"><span class="comment">//mockito    </span></div><div class="line">testCompile <span class="string">"org.mockito:mockito-core:1.+"</span>&#125;</div></pre></td></tr></table></figure>
<p>先看代码这个是一个简单的login代码<br>Activity</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span>, <span class="title">ILoginView</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> EditText mUserNameView;</div><div class="line">    <span class="keyword">private</span> EditText mPassWordView;</div><div class="line">    <span class="keyword">private</span> LoginPresenter mPresenter;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">        findViewById(R.id.login).setOnClickListener(<span class="keyword">this</span>);</div><div class="line">        mUserNameView = (EditText) findViewById(R.id.username);</div><div class="line">        mPassWordView = (EditText) findViewById(R.id.password);</div><div class="line">        mPresenter = <span class="keyword">new</span> LoginPresenter(<span class="keyword">this</span>, HttpClient.getInstance());</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span> (v.getId()) &#123;</div><div class="line">            <span class="keyword">case</span> R.id.login:</div><div class="line">                String username = mUserNameView.getText().toString();</div><div class="line">                String password = mPassWordView.getText().toString();</div><div class="line">                <span class="keyword">if</span> (TextUtils.isEmpty(username)) &#123;</div><div class="line">                    Toast.makeText(<span class="keyword">this</span>, <span class="string">"用户名不能为空"</span>, Toast.LENGTH_LONG).show();</div><div class="line">                    <span class="keyword">return</span>;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TextUtils.isEmpty(password)) &#123;</div><div class="line">                    Toast.makeText(<span class="keyword">this</span>, <span class="string">"密码不能为空"</span>, Toast.LENGTH_LONG).show();</div><div class="line">                    <span class="keyword">return</span>;</div><div class="line">                &#125;</div><div class="line">                mPresenter.login(username, password);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startHomeView</span><span class="params">()</span> </span>&#123;</div><div class="line">        Toast.makeText(<span class="keyword">this</span>, <span class="string">"跳转主页"</span>, Toast.LENGTH_LONG).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">()</span> </span>&#123;</div><div class="line">        Toast.makeText(<span class="keyword">this</span>, <span class="string">"密码错误"</span>, Toast.LENGTH_LONG).show();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ILoginView接口</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ILoginView</span> &#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 跳转主页</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startHomeView</span>(<span class="params"></span>)</span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 错误</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onError</span>(<span class="params"></span>)</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>HttpClient</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HttpClient mClient;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HttpClient <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mClient == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">synchronized</span> (HttpClient.class) &#123;</div><div class="line">                <span class="keyword">if</span> (mClient == <span class="keyword">null</span>) &#123;</div><div class="line">                    mClient = <span class="keyword">new</span> HttpClient();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> mClient;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Callback</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String phone)</span></span>;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(String error)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String username, String password, Callback callback)</span> </span>&#123;</div><div class="line">        <span class="comment">//为了简单,没有实际操作网络请求只是简单判断返回结果</span></div><div class="line">        <span class="keyword">if</span> (username.length() &lt; <span class="number">5</span>) &#123;</div><div class="line">            callback.onError(<span class="string">"用户名太短"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            callback.onSuccess(<span class="string">"110110"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>LoginPresenter</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> LoginPresenter &#123;</div><div class="line">    <span class="keyword">private</span> ILoginView mLoginView;</div><div class="line">    <span class="keyword">private</span> HttpClient mClient;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> LoginPresenter(<span class="meta">@NonNull</span> ILoginView mLoginView,<span class="meta">@NonNull</span> HttpClient client) &#123;</div><div class="line">        <span class="keyword">this</span>.mLoginView = mLoginView;</div><div class="line">        <span class="keyword">this</span>.mClient = client;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="built_in">void</span> login(<span class="built_in">String</span> username, <span class="built_in">String</span> password) &#123;</div><div class="line">        mClient.login(username, password, <span class="keyword">new</span> HttpClient.Callback() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="keyword">public</span> <span class="built_in">void</span> onSuccess(<span class="built_in">String</span> phone) &#123;</div><div class="line">                mLoginView.startHomeView();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="keyword">public</span> <span class="built_in">void</span> onError(<span class="built_in">String</span> error) &#123;</div><div class="line">                mLoginView.onError();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="built_in">String</span> getDevice() &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"nexus6p"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>单元测试，mock出来的对象一定要set到这个LoginPresenter对象中，要不然报错org.mockito.exceptions.misusing.NotAMockException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginPresenterTest</span> </span>&#123;    </div><div class="line"><span class="keyword">private</span> LoginPresenter mPresenter;    </div><div class="line"><span class="keyword">private</span> ILoginView mLoginView;    </div><div class="line"><span class="keyword">private</span> HttpClient mClient;    </div><div class="line"><span class="comment">//初始化,每测试一个方法都会掉这个    </span></div><div class="line"><span class="meta">@Before</span>    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </div><div class="line">mLoginView = Mockito.mock(ILoginView.class);        </div><div class="line">mClient = Mockito.mock(HttpClient.class);        </div><div class="line">mPresenter = <span class="keyword">new</span> LoginPresenter(mLoginView, mClient);   </div><div class="line"> &#125;    </div><div class="line"><span class="meta">@Test</span>    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </div><div class="line"><span class="comment">//无返回值方法        </span></div><div class="line">mPresenter.login(<span class="string">"123456"</span>, <span class="string">"123456"</span>);   </div><div class="line">     Mockito.verify(mClient).login(<span class="string">"123456"</span>, <span class="string">"123456"</span>, <span class="keyword">null</span>);    </div><div class="line">&#125;    </div><div class="line"><span class="meta">@Test</span>    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loginTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </div><div class="line"><span class="comment">//无返回值方法        </span></div><div class="line">mPresenter.loginTest(<span class="string">"123456"</span>, <span class="string">"123456"</span>);        </div><div class="line">Mockito.verify(mClient).login(<span class="string">"123456"</span>, <span class="string">"123456"</span>, <span class="keyword">null</span>);    </div><div class="line">&#125;    </div><div class="line"><span class="meta">@Test</span>    </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getDevice</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </div><div class="line"><span class="comment">//有返回值方法"        </span></div><div class="line">Assert.assertEquals(mPresenter.getDevice(), <span class="string">"nexus6p"</span>);    </div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行看结果</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-6e66d663c451a176.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="结果"><br>可以看出login方法有问题，这个错误是正常的，就是我要的结果，可是loginTest方法运行正常，最主要的是他们callback为null，login方法执行的callback不是null，所有login方法执行的时候验证出来就是不一致的。</p>
<ul>
<li>资料<ul>
<li><a href="">Demo地址</a></li>
<li><a href="http://chriszou.com/" target="_blank" rel="external">小创</a></li>
<li><a href="http://tech.meituan.com/" target="_blank" rel="external">美团点评技术团队</a></li>
<li><a href="http://www.ituring.com.cn/book/1336" target="_blank" rel="external">单元测试的艺术</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/单元测试/">单元测试</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-App共享文件权限" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/17/App共享文件权限/" class="article-date">
      <time datetime="2016-06-17T10:30:00.000Z" itemprop="datePublished">2016-06-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/17/App共享文件权限/">App共享文件Uri不能为file://</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li>先看异常信息:</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">E/StrictMode: null</div><div class="line">              java<span class="selector-class">.lang</span><span class="selector-class">.Throwable</span>: file:<span class="comment">// Uri exposed through Intent.getData()</span></div><div class="line">                  at android<span class="selector-class">.os</span><span class="selector-class">.StrictMode</span><span class="selector-class">.onFileUriExposed</span>(StrictMode<span class="selector-class">.java</span>:<span class="number">1757</span>)</div><div class="line">                  at android<span class="selector-class">.net</span><span class="selector-class">.Uri</span><span class="selector-class">.checkFileUriExposed</span>(Uri<span class="selector-class">.java</span>:<span class="number">2346</span>)</div><div class="line">                  at android<span class="selector-class">.content</span><span class="selector-class">.Intent</span><span class="selector-class">.prepareToLeaveProcess</span>(Intent<span class="selector-class">.java</span>:<span class="number">8045</span>)</div><div class="line">                  at android<span class="selector-class">.app</span><span class="selector-class">.Instrumentation</span><span class="selector-class">.execStartActivity</span>(Instrumentation<span class="selector-class">.java</span>:<span class="number">1506</span>)</div><div class="line">                  at android<span class="selector-class">.app</span><span class="selector-class">.Activity</span><span class="selector-class">.startActivityForResult</span>(Activity<span class="selector-class">.java</span>:<span class="number">3930</span>)</div><div class="line">                  at android<span class="selector-class">.app</span><span class="selector-class">.Activity</span><span class="selector-class">.startActivityForResult</span>(Activity<span class="selector-class">.java</span>:<span class="number">3890</span>)</div><div class="line">                  at android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.app</span><span class="selector-class">.FragmentActivity</span><span class="selector-class">.startActivityForResult</span>(FragmentActivity<span class="selector-class">.java</span>:<span class="number">843</span>)</div><div class="line">                  at android<span class="selector-class">.app</span><span class="selector-class">.Activity</span><span class="selector-class">.startActivity</span>(Activity<span class="selector-class">.java</span>:<span class="number">4213</span>)</div><div class="line">                  at android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.app</span><span class="selector-class">.ActivityCompatJB</span><span class="selector-class">.startActivity</span>(ActivityCompatJB<span class="selector-class">.java</span>:<span class="number">26</span>)</div><div class="line">                  at android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.app</span><span class="selector-class">.ActivityCompat</span><span class="selector-class">.startActivity</span>(ActivityCompat<span class="selector-class">.java</span>:<span class="number">133</span>)</div><div class="line">                  at com<span class="selector-class">.horizon</span><span class="selector-class">.offer</span><span class="selector-class">.mail</span><span class="selector-class">.maildetail</span><span class="selector-class">.impl</span><span class="selector-class">.ImageAnnexWrapper</span><span class="selector-class">.openFile</span>(ImageAnnexWrapper<span class="selector-class">.java</span>:<span class="number">26</span>)</div><div class="line">                  at com<span class="selector-class">.horizon</span><span class="selector-class">.offer</span><span class="selector-class">.mail</span><span class="selector-class">.maildetail</span><span class="selector-class">.MailDetailActivity</span><span class="selector-class">.openAnnexFile</span>(MailDetailActivity<span class="selector-class">.java</span>:<span class="number">184</span>)</div><div class="line">                  at com<span class="selector-class">.horizon</span><span class="selector-class">.offer</span><span class="selector-class">.mail</span><span class="selector-class">.maildetail</span><span class="selector-class">.adapter</span><span class="selector-class">.MailAnnexAdapter</span><span class="variable">$MailAnnexViewHolder</span>$<span class="number">1</span>.onClick(MailAnnexAdapter<span class="selector-class">.java</span>:<span class="number">75</span>)</div><div class="line">                  at android<span class="selector-class">.view</span><span class="selector-class">.View</span><span class="selector-class">.performClick</span>(View<span class="selector-class">.java</span>:<span class="number">5204</span>)</div><div class="line">                  at android<span class="selector-class">.view</span><span class="selector-class">.View</span><span class="variable">$PerformClick</span>.run(View<span class="selector-class">.java</span>:<span class="number">21153</span>)</div><div class="line">                  at android<span class="selector-class">.os</span><span class="selector-class">.Handler</span><span class="selector-class">.handleCallback</span>(Handler<span class="selector-class">.java</span>:<span class="number">739</span>)</div><div class="line">                  at android<span class="selector-class">.os</span><span class="selector-class">.Handler</span><span class="selector-class">.dispatchMessage</span>(Handler<span class="selector-class">.java</span>:<span class="number">95</span>)</div><div class="line">                  at android<span class="selector-class">.os</span><span class="selector-class">.Looper</span><span class="selector-class">.loop</span>(Looper<span class="selector-class">.java</span>:<span class="number">148</span>)</div><div class="line">                  at android<span class="selector-class">.app</span><span class="selector-class">.ActivityThread</span><span class="selector-class">.main</span>(ActivityThread<span class="selector-class">.java</span>:<span class="number">5417</span>)</div><div class="line">                  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span><span class="selector-class">.invoke</span>(Native Method)</div><div class="line">                  at com<span class="selector-class">.android</span><span class="selector-class">.internal</span><span class="selector-class">.os</span><span class="selector-class">.ZygoteInit</span><span class="variable">$MethodAndArgsCaller</span>.run(ZygoteInit<span class="selector-class">.java</span>:<span class="number">726</span>)</div><div class="line">                  at com<span class="selector-class">.android</span><span class="selector-class">.internal</span><span class="selector-class">.os</span><span class="selector-class">.ZygoteInit</span><span class="selector-class">.main</span>(ZygoteInit<span class="selector-class">.java</span>:<span class="number">616</span>)</div></pre></td></tr></table></figure>
<p>在StrictMode(严格)模式下，App之间共享资源报的异常。</p>
<ul>
<li>出现这个异常的代码</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public <span class="keyword">void</span> openFile(<span class="meta">@NonNull</span> Activity activity, <span class="meta">@NonNull</span> File file) &#123;</div><div class="line">        Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</div><div class="line">        intent.addCategory(Intent.CATEGORY_DEFAULT);</div><div class="line">        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</div><div class="line">        <span class="comment"><span class="markdown">/<span class="strong">**异常这行代码**</span>/</span></span></div><div class="line">        intent.setDataAndType(<span class="built_in">Uri</span>.fromFile(file), <span class="string">"image/*"</span>);</div><div class="line">        ActivityCompat.startActivity(activity, intent, <span class="keyword">null</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>打印</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Uri.fromFile(<span class="built_in">file</span>)</div></pre></td></tr></table></figure>
<p>输出信息</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Uri uri=file:<span class="regexp">//</span><span class="regexp">/storage/</span>emulated<span class="regexp">/0/</span>download<span class="regexp">/9text.jpg</span></div></pre></td></tr></table></figure>
<ul>
<li>各方说明<ul>
<li><a href="https://developer.android.com/preview/behavior-changes.html#sharing-files" target="_blank" rel="external">Android N中说明Uri不能以file://的原因</a><ul>
<li>传递软件包网域外的 file:// URI 可能给接收器留下无法访问的路径。</li>
<li>访问权限控制 </li>
</ul>
</li>
</ul>
</li>
<li><a href="https://developer.android.com/preview/behavior-changes.html#sharing-files" target="_blank" rel="external">解决办法</a><ul>
<li><a href="https://developer.android.com/reference/android/support/v4/content/FileProvider.html" target="_blank" rel="external">FileProvider</a></li>
</ul>
</li>
<li><p>总结</p>
<ul>
<li><p>开始搜索Uri.fromFile(file)并分析源码</p>
 <figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">  * Creates a Uri from a file. The URI has the form</div><div class="line">  * "file://&lt;absolute path&gt;". Encodes path characters with the exception of</div><div class="line">  * '/'.</div><div class="line">  *</div><div class="line">  * &lt;p&gt;Example: "file:///tmp/android.txt"</div><div class="line">  *</div><div class="line">  * @throws NullPointerException if file is null</div><div class="line">  * @return a Uri for the given file</div><div class="line">  */</div><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Uri fromFile(<span class="keyword">File</span> <span class="keyword">file</span>) &#123;</div><div class="line">     <span class="keyword">if</span> (<span class="keyword">file</span> == <span class="keyword">null</span>) &#123;</div><div class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"file"</span>);</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     PathPart path = PathPart.fromDecoded(<span class="keyword">file</span>.getAbsolutePath());</div><div class="line">     <span class="keyword">return</span> <span class="keyword">new</span> HierarchicalUri(</div><div class="line">             <span class="string">"file"</span>, Part.EMPTY, path, Part.<span class="keyword">NULL</span>, Part.<span class="keyword">NULL</span>);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p> 没有找到相关解决方案。</p>
</li>
<li><a href="https://developer.android.com/reference/android/os/StrictMode.VmPolicy.Builder.html#detectFileUriExposure(" target="_blank" rel="external">StrictMode的FileUriExposedException异常检测</a>)中有提到FileProvider的使用</li>
<li>我写的一个<a href="https://github.com/milin411/FileIntentDemo.git" target="_blank" rel="external">demo</a></li>
<li>给以后提醒app之间共享数据传Uri不能传file://</li>
</ul>
</li>
<li><p>参考资料</p>
<ul>
<li><a href="https://developer.android.com/reference/android/os/StrictMode.html" target="_blank" rel="external">StrictMode</a> </li>
<li><a href="http://www.jianshu.com/p/5572b42fc63f" target="_blank" rel="external">Android Uri和Java URI的区别</a></li>
<li><a href="http://blog.csdn.net/dlutbrucezhang/article/details/8917303" target="_blank" rel="external">Android的Uri</a> </li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/44679239" target="_blank" rel="external">Uri详解之——Uri结构与代码提取</a></li>
<li><a href="http://blog.csdn.net/zhangyingli/article/details/37902367" target="_blank" rel="external">根据 Android Training课程写的FileProvider小例子</a></li>
<li><a href="https://developer.android.com/preview/behavior-changes.html#sharing-files" target="_blank" rel="external">FileUriExposedException 异常</a></li>
<li><a href="https://developer.android.com/reference/android/support/v4/content/FileProvider.html" target="_blank" rel="external">FileProvider</a></li>
<li><a href="http://blog.csdn.net/zhangyingli/article/details/37902367" target="_blank" rel="external">FileProvider使用</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Android/">Android</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Android-mvp" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/01/Android-mvp/" class="article-date">
      <time datetime="2016-04-01T10:30:00.000Z" itemprop="datePublished">2016-04-01</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/01/Android-mvp/">Android-mvp</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li><a href="http://www.cnblogs.com/end/archive/2011/06/02/2068512.html" target="_blank" rel="external">mvc与mvp对比</a></li>
<li><p>mvp</p>
<ul>
<li>model:依然是业务逻辑和实体模型</li>
<li>view:对应于Activity，负责View的绘制以及与用户交互</li>
<li>presenter:负责完成View于Model间的交互</li>
<li>关系图<br><img src="http://www.jcodecraeer.com/uploads/20150227/1424969040503730.png" alt="mvp关系图"></li>
</ul>
</li>
<li><p>View定义定义包括：Activity,xml,Fragment，adapter</p>
</li>
<li>Google定义MVP</li>
</ul>
<p><img src="https://github.com/googlesamples/android-architecture/wiki/images/mvp.png" alt="Google-mvp"></p>
<p> <a href="https://github.com/googlesamples/android-architecture/tree/todo-mvp/todoapp" target="_blank" rel="external">Google-MVP-demo</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Android/">Android</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Android单元测试框架" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/18/Android单元测试框架/" class="article-date">
      <time datetime="2016-03-18T10:30:00.000Z" itemprop="datePublished">2016-03-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/18/Android单元测试框架/">Android单元测试框架</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Android单元测试框架"><a href="#Android单元测试框架" class="headerlink" title="Android单元测试框架"></a>Android单元测试框架</h2><ul>
<li>Android单元测试<ul>
<li>在Android项目中，单元测试的对象是组件状态、控件行为、界面元素和自定义函数。不推荐对每个函数进行一对一的测试，像onStart()、onDestroy()这些周期函数并不需要全部覆盖到。  </li>
</ul>
</li>
<li>框架比较<ul>
<li>JUnit<ul>
<li>原生单元测试</li>
<li>不能让Activity执行到resume的状态</li>
<li>@王进已讲</li>
</ul>
</li>
<li>AndroidTest<ul>
<li>运行在Android环境</li>
</ul>
</li>
<li>Instrumentation<ul>
<li>运行在模拟器上</li>
</ul>
</li>
<li>Robotium<ul>
<li>类似于Selenium的测试框架</li>
<li>运行在模拟器上</li>
<li>通过对模拟器的操作或者mock，来触发函数调用，进而对其结果进行验证</li>
</ul>
</li>
<li>Robolectric+Mock(Mockito)<ul>
<li>运行在JVM上速度快</li>
<li>Jenkins周期性执行</li>
<li>无需准备Android环境</li>
<li>实现了Android中对XML的解析，模拟了View，Layout，以及资源的加载</li>
<li>一些测试对象依赖度较高而需要解除依赖的场景(如网络)使用Mock框架</li>
</ul>
</li>
</ul>
</li>
<li><p><a href="http://robolectric.org/getting-started/" target="_blank" rel="external">Robolectric</a></p>
<ul>
<li><p>Android Studio配置</p>
<ul>
<li><p>build.gradle添加库</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">testCompile</span> "<span class="selector-tag">org</span><span class="selector-class">.robolectric</span><span class="selector-pseudo">:robolectric</span><span class="selector-pseudo">:3.0"</span></div></pre></td></tr></table></figure>
</li>
<li><p>Build Variants设置<br><img src="http://robolectric.org/images/android-studio-enable-unit-tests-f15bd816.png" alt="Unit Tests"></p>
</li>
<li>Linux和Mac平台的需要配置下才能运行:在Android Studio中run边上有一个app选择，这里选择”Edit Configurations” 出现编辑界面<br><img src="" alt="Run/Debug Configurations"><br>在左边中新建JUnit，Default-&gt;JUnit</li>
<li>测试代码</li>
<li>中间出现问题<ul>
<li>Android SDK目前只支持到22，5.1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>单元测试的目标函数主要有三种：</p>
<ol>
<li>有明确的返回值，如上图的dosomething(Boolean param)，做单元测试时，只需调用这个函数，然后验证函数的返回值是否符合预期结果。</li>
<li>这个函数只改变其对象内部的一些属性或者状态，函数本身没有返回值，就验证它所改变的属性和状态。</li>
<li>一些函数没有返回值，也没有直接改变哪个值的状态，这就需要验证其行为，比如点击事件。 </li>
</ol>
<ul>
<li>既没有返回值，也没有改变状态，又没有触发行为的函数是不可测试的，在项目中不应该存在。当存在同时具备上述多种特性时，本文建议采用多个case来真对每一种特性逐一验证，或者采用一个case，逐一执行目标函数并验证其影响。</li>
<li>构造用例的原则是测试用例与函数一对一，实现条件覆盖与路径覆盖。Java单元测试中，良好的单元测试是需要保证所有函数执行正确的，即所有边界条件都验证过，一个用例只测一个函数，便于维护。在Android单元测试中，并不要求对所有函数都覆盖到，像Android SDK中的函数回调则不用测试。</li>
</ul>
</li>
<li><p>测试用例</p>
<ul>
<li><p>组件</p>
<ul>
<li><p>Activity测试</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">		@Test</div><div class="line">    public void testLifecycle() &#123;</div><div class="line">        ActivityController&lt;MainActivity&gt; activityController = Robolectric.buildActivity(MainActivity.class).create().start();</div><div class="line">        Activity activity = activityController.get();</div><div class="line">        Button action_next = (Button) activity.findViewById(R.id.next);</div><div class="line">        Assert.assertEquals("next", action_next.getText().toString());</div><div class="line"><span class="comment">//        error</span></div><div class="line"><span class="comment">//        Assert.assertEquals("testLifecycle", action_next.getText().toString());</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">		````  </div><div class="line">		-<span class="ruby"> Service</span></div><div class="line">		-<span class="ruby"> BroadcastReceiver</span></div><div class="line">		-<span class="ruby"> Fragment </span></div><div class="line">	-<span class="ruby"> 控件行为</span></div><div class="line">		-<span class="ruby"> 跳转</span></div><div class="line">	-<span class="ruby"> 界面元素</span></div><div class="line">		-<span class="ruby"> Toast</span></div></pre></td></tr></table></figure>
<p>@Test<br>public void testToast() {<br>Button action_toast = (Button) mActivity.findViewById(R.id.action_toast);<br>action_toast.performClick();<br>Assert.assertEquals(“hello”, ShadowToast.getTextOfLatestToast());<br>}</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"> Dialog</span></div><div class="line">-<span class="ruby"> UI控件</span></div></pre></td></tr></table></figure>
<p>@Test<br>public void testStartEndActivity() {<br>Button action_next = (Button) mActivity.findViewById(R.id.next);<br>action_next.performClick();</p>
<p>Intent intent = new Intent(mActivity, EndActivity.class);</p>
<p>Intent actionIntent = ShadowApplication.getInstance().getNextStartedActivity();<br>Assert.assertEquals(intent, actionIntent);<br>}<br>````</p>
</li>
</ul>
</li>
<li>自定义函数</li>
<li>网络请求</li>
</ul>
</li>
<li>assertJ-android断言库</li>
<li>资料<ul>
<li><a href="https://hkliya.gitbooks.io/unit-test-android-with-robolectric/content/0-introduction.html" target="_blank" rel="external">参考1</a></li>
<li><a href="http://tech.meituan.com/Android_unit_test.html" target="_blank" rel="external">美团Android单元测试</a></li>
<li><a href="http://www.jianshu.com/p/9d988a2f8ff7" target="_blank" rel="external">测试用例</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/单元测试/">单元测试</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Moto-360-Sport初体验" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/04/Moto-360-Sport初体验/" class="article-date">
      <time datetime="2016-03-04T10:30:00.000Z" itemprop="datePublished">2016-03-04</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/04/Moto-360-Sport初体验/">Moto 360 Sport初体验</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Moto-360-Sport初体验"><a href="#Moto-360-Sport初体验" class="headerlink" title="Moto 360 Sport初体验"></a>Moto 360 Sport初体验</h2><ul>
<li>前奏<ul>
<li>美版</li>
<li>第一连接需要连接Android手机</li>
<li>需要翻墙</li>
</ul>
</li>
<li>应用<ul>
<li>Android  Wear</li>
<li>WearADay</li>
</ul>
</li>
<li>iPhone支持<ul>
<li>无需越狱，连接应用WearADay<ul>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055266573.jpg" alt="如图1"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055336913.jpg" alt="如图2"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055318883.jpg" alt="如图3"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055318092.jpg" alt="如图4"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055331041.jpg" alt="如图5"></li>
</ul>
</li>
<li>包括来电，信息以及各种应用的通知，包括 QQ，微信等等在 iPhone 和 Moto360 配对成功之后都可以在 Moto360 上显示<ul>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055428219.jpg" alt="如图1"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055481895.jpg" alt="如图2"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055447453.jpg" alt="如图3"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055512184.jpg" alt="如图4"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055547831.jpg" alt="如图5"></li>
<li><img src="http://pic.5577.com/up/2015-5/2015050417055580691.jpg" alt="如图6"></li>
</ul>
</li>
</ul>
</li>
<li>Android支持<ul>
<li>微信:表情回复，语音回复，文字回复</li>
<li>QQ:未测</li>
</ul>
</li>
<li>缺陷<ul>
<li>分辨率不高</li>
<li>目前测试没有好的输入法每次提示都是在连接手机输入但每次都是提示手机不在附近</li>
</ul>
</li>
</ul>
<ul>
<li><p>开发者模式安装应用</p>
<ol>
<li>打开手机以及手表的开发者选项<ul>
<li>手机端：设置-关于手机，找到“版本号”，对着它连续点击7下即可开启，开机后进入“设置”-“开发者选项”，勾选“USB调试</li>
<li><img src="http://image.anruan.com/imglist/20141021/20141021863912.png" alt="手机开启develp"></li>
<li>手表端：长按右侧按钮唤出设置界面-“About”，找到“Build number”，对着它连续点击7下即可开启，开启后进入设置-“Developer options”，按图所示开启“ADB debugging”和“Debug over Bluetooth”</li>
<li><img src="http://image.anruan.com/imglist/20141021/20141021863360.png" alt="Moto开启develp"></li>
</ul>
</li>
<li>打开Android Wear软件，勾选设置菜单里的“Debugging over Bluetooth”。<ul>
<li>你可以发现“Host”是disconnected未连接状态，这是代表手表端;“Target”是手机端，connected已连接状态;怎么让手表端的显示已连接呢?请继续往下看</li>
<li><img src="http://image.anruan.com/imglist/20141021/20141021863594.png" alt="Android Wear打开蓝牙调试"> </li>
</ul>
</li>
<li><p>把手机连接上电脑，在adb工具的文件夹里调出命令行，依次输入以下命令</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adb forward <span class="string">tcp:</span><span class="number">4444</span> <span class="string">localabstract:</span>/adb-hub</div><div class="line">　　adb connect <span class="string">localhost:</span><span class="number">4444</span></div></pre></td></tr></table></figure>
<p>分两次输入(电脑需支持adb命令，如果不支持请百度<a href="http://blog.sina.com.cn/s/blog_6268f10201016s64.html" target="_blank" rel="external">Mac配置adb</a>，<a href="http://blog.csdn.net/huangbiao86/article/details/6664779" target="_blank" rel="external">Window配置adb</a>两个链接是未测试)</p>
</li>
</ol>
<ul>
<li>输完以上两条命令后，留意手机，会弹出允许USB调试的窗口，勾选总是允许，点击OK即可，这时你就发现代表手表端的“Host”就变成connected已连接状态了，嗯，这就代表可以再电脑执行adb命令来控制手表了</li>
<li><img src="http://image.anruan.com/imglist/20141021/20141021863363.png" alt="提示是否调试"></li>
</ul>
<ol>
<li><p>相关命令</p>
<ul>
<li>adb devices (显示已连接的设备，如图所示，会显示出2个设备名，分别对应手机和手表)</li>
<li><p><img src="http://image.anruan.com/imglist/20141021/20141021863452.png" alt="如图"></p>
</li>
<li><p>adb -s 手机ID号 install xxx.apk(给手机安装软件，要注意加上手机ID号，比如我的就是 adb -s TA26901ZLK install xxx.apk )</p>
</li>
<li>adb -s localhost:4444 install xxx.apk(给手表安装软件，MOTO 360的软件apk可以通过Android Wear软件专题下载，这里是通过手机的蓝牙给手表安装的，所以传输速度稍慢，要耐心等待，安装成功后会有提示)</li>
<li>adb -s localhost:4444 unistall xxx(卸载手表端的某个软件，比如adb -s localhost:4444unistall com.whirlscape.minuum)</li>
<li><p>查看Moto 360所有app的packages</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb -s localhos<span class="variable">t:4444</span> <span class="keyword">shell</span> pm <span class="keyword">list</span> packages</div></pre></td></tr></table></figure>
</li>
<li><p>卸载指定包名的app</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb -s localhost:4444 <span class="keyword">uninstall</span> [-k] &lt;<span class="keyword">insert</span> <span class="keyword">package</span> <span class="keyword">name</span> here&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<ul>
<li>参考文章<ul>
<li><a href="http://m.anruan.com/view_5488.html" target="_blank" rel="external">链接1</a></li>
<li><a href="https://www.reddit.com/r/moto360/comments/3bkd5r/remove_wear_apps_without_uninstalling_app_from/" target="_blank" rel="external">链接2</a> </li>
<li><a href="http://www.5577.com/wear/58563.html" target="_blank" rel="external">链接3</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Android/">Android</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-tablayout方法setupWithViewPager-坑" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/29/tablayout方法setupWithViewPager-坑/" class="article-date">
      <time datetime="2016-01-29T10:30:00.000Z" itemprop="datePublished">2016-01-29</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/29/tablayout方法setupWithViewPager-坑/">tablayout方法setupWithViewPager()坑</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h4 id="tablayout方法setupWithViewPager-坑-吴明"><a href="#tablayout方法setupWithViewPager-坑-吴明" class="headerlink" title="tablayout方法setupWithViewPager()坑 - 吴明"></a>tablayout方法setupWithViewPager()坑 - 吴明</h4><ul>
<li>tallayout平常使用setupWithViewPager()</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ViewPager viewPager=(ViewPager)findViewById(R.id.view_pager)<span class="comment">;</span></div><div class="line">TabLayout tabContainView = (TabLayout) findViewById(R.id.pick_school_category_contain)<span class="comment">;</span></div><div class="line">viewPager.setAdatper(new FragmentStatePagerAdapter(FragmentManager,fragments))<span class="comment">;</span></div><div class="line">tabContainView. setupWithViewPager(viewPager)<span class="comment">;</span></div></pre></td></tr></table></figure>
<ul>
<li>查看setupWithViewPager()方法源码</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setupWithViewPager</span><span class="params">(@NonNull ViewPager viewPager)</span> </span>&#123;</div><div class="line">       <span class="keyword">final</span> PagerAdapter adapter = viewPager.getAdapter();</div><div class="line">       <span class="keyword">if</span> (adapter == <span class="keyword">null</span>) &#123;</div><div class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"ViewPager does not have a PagerAdapter set"</span>);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="comment">// First we'll add Tabs, using the adapter's page titles</span></div><div class="line">       setTabsFromPagerAdapter(adapter);</div><div class="line"></div><div class="line">       <span class="comment">// Now we'll add our page change listener to the ViewPager</span></div><div class="line">       viewPager.addOnPageChangeListener(<span class="keyword">new</span> TabLayoutOnPageChangeListener(<span class="keyword">this</span>));</div><div class="line"></div><div class="line">       <span class="comment">// Now we'll add a tab selected listener to set ViewPager's current item</span></div><div class="line">       setOnTabSelectedListener(<span class="keyword">new</span> ViewPagerOnTabSelectedListener(viewPager));</div><div class="line"></div><div class="line">       <span class="comment">// Make sure we reflect the currently set ViewPager item</span></div><div class="line">       <span class="keyword">if</span> (adapter.getCount() &gt; <span class="number">0</span>) &#123;</div><div class="line">           <span class="keyword">final</span> <span class="keyword">int</span> curItem = viewPager.getCurrentItem();</div><div class="line">           <span class="keyword">if</span> (getSelectedTabPosition() != curItem) &#123;</div><div class="line">               selectTab(getTabAt(curItem));</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>就会发现这里有三个坑</p>
<ul>
<li><p>setTabsFromPagerAdapter</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">setTabsFromPagerAdapter</span>(<span class="variable">@NonNull</span> PagerAdapter adapter) &#123;</div><div class="line">       <span class="selector-tag">removeAllTabs</span>();</div><div class="line">       <span class="selector-tag">for</span> (int i = <span class="number">0</span>, count = adapter.getCount(); i &lt; count; i++) &#123;</div><div class="line">           <span class="selector-tag">addTab</span>(newTab().setText(adapter.getPageTitle(i)));</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>removeAllTabs()这个就是说把前面所有tablayout添加的view都删掉。也就是说在之前不管怎么处理view都被干掉。然后设置为PagerAdapter返回的title</p>
</li>
<li><p>setOnTabSelectedListener(new ViewPagerOnTabSelectedListener(viewPager));</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewPagerOnTabSelectedListener</span> <span class="keyword">implements</span> <span class="title">TabLayout</span>.<span class="title">OnTabSelectedListener</span> </span>&#123;</div><div class="line">      <span class="keyword">private</span> <span class="keyword">final</span> ViewPager mViewPager;</div><div class="line"></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="title">ViewPagerOnTabSelectedListener</span><span class="params">(ViewPager viewPager)</span> </span>&#123;</div><div class="line">          mViewPager = viewPager;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabSelected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</div><div class="line">          mViewPager.setCurrentItem(tab.getPosition());</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabUnselected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</div><div class="line">          <span class="comment">// No-op</span></div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabReselected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</div><div class="line">          <span class="comment">// No-op</span></div><div class="line">      &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>  这里主要不算不算太坑，最主要的是设置了点击tablayot默认是viewpager是滚动的，自己可以设置这个时间监听。重写他的方法</p>
</li>
<li><p>selectTab(getTabAt(curItem));</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (adapter.getCount() &gt; <span class="number">0</span>) &#123;</div><div class="line">           <span class="keyword">final</span> <span class="keyword">int</span> curItem = viewPager.getCurrentItem();</div><div class="line">           <span class="keyword">if</span> (getSelectedTabPosition() != curItem) &#123;</div><div class="line">               selectTab(getTabAt(curItem));</div><div class="line">           &#125;</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<p>这里最主要是第一次默认选中第一个。相对应一些viewpager第一次就选中的不是第一个，这个就是一个很大的一个问题就是相当于viewpager点击了两次。</p>
</li>
<li>分享这个坑主要是给大家提前填。以后还是不能偷懒就为了省代码而忘了看封装的方法的代码是不是有问题。</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Android/">Android</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Chrome/">Chrome</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tablayout/">tablayout</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/坑/">坑</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Android微信抢红包" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/15/Android微信抢红包/" class="article-date">
      <time datetime="2016-01-15T10:30:00.000Z" itemprop="datePublished">2016-01-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/15/Android微信抢红包/">Android 微信抢红包</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Android-微信抢红包"><a href="#Android-微信抢红包" class="headerlink" title="Android 微信抢红包"></a>Android 微信抢红包</h2><ul>
<li><p>主要原理：监听微信APP,如果发送[微信红包]相关通知,则通过Android辅助类服务AccessibilityService实现抢红包点击一系列动作</p>
</li>
<li><p>通过AccessibilityService服务监听微信</p>
</li>
<li>主要监听配置如下:</li>
</ul>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">监听动作类型</div><div class="line"><span class="symbol">android:</span>accessibilityEventTypes=<span class="string">"typeNotificationStateChanged|typeWindowStateChanged|typeViewScrolled"</span></div><div class="line">完成反馈动作类型</div><div class="line"><span class="symbol">android:</span>accessibilityFeedbackType=<span class="string">"feedbackGeneric"</span></div><div class="line">标识</div><div class="line"><span class="symbol">android:</span>accessibilityFlags=<span class="string">""</span></div><div class="line">是否可以屏幕内容</div><div class="line"><span class="symbol">android:</span>canRetrieveWindowContent=<span class="string">"true"</span></div><div class="line">服务描述</div><div class="line"><span class="symbol">android:</span>description=<span class="string">"@string/server_description"</span></div><div class="line">通知反应时间</div><div class="line"><span class="symbol">android:</span>notificationTimeout=<span class="string">"0"</span></div><div class="line">监听应用包名</div><div class="line"><span class="symbol">android:</span>packageNames=<span class="string">"com.tencent.mm"</span></div></pre></td></tr></table></figure>
<ul>
<li>AccessibilityService实现方法：<ul>
<li>onAccessibilityEvent()时间监听回调方法</li>
<li>onServiceConnected启动服务</li>
<li>onUnbind服务器解绑</li>
<li>onInterrupt中断服务</li>
</ul>
</li>
<li><p>事件</p>
<ul>
<li>AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED:通知消息事件</li>
<li>AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED:屏幕window变化时间</li>
<li>AccessibilityEvent.TYPE_VIEW_SCROLLED屏幕滚动监听事件</li>
</ul>
</li>
<li><p>1.微信后台抢红包：</p>
<ul>
<li>后台TYPE_NOTIFICATION_STATE_CHANGED事件监听有[微信红包]通知则点击通知，TYPE_WINDOW_STATE_CHANGED事件点击‘抢红包’，TYPE_WINDOW_STATE_CHANGED点击‘拆红包’，TYPE_WINDOW_STATE_CHANGED跳转红包查看详情</li>
</ul>
</li>
<li>2.微信当前聊天页面抢红包<ul>
<li>当前聊天页面，不能接受通知</li>
<li>AccessibilityEvent.TYPE_VIEW_SCROLLED监听屏幕view有新消息，则查看屏幕是否有’抢红包’view，有则点击‘抢红包’view,点击抢红包后则同上通过TYPE_WINDOW_STATE_CHANGED事件完成抢红包一系列动作</li>
</ul>
</li>
<li><a href="https://github.com/milin411/RedWallet.git" target="_blank" rel="external">代码地址</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Android/">Android</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Why-Git-Learn-It" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/07/Why-Git-Learn-It/" class="article-date">
      <time datetime="2016-01-06T16:00:00.000Z" itemprop="datePublished">2016-01-06</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/07/Why-Git-Learn-It/">Why Git? Learn It!</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Why-Git-Learn-It-曾铭"><a href="#Why-Git-Learn-It-曾铭" class="headerlink" title="Why Git? Learn It! -曾铭"></a>Why Git? Learn It! -曾铭</h2><ul>
<li>为什么要用 Git？</li>
<li>Git + SourceTree + Gitlab 的使用演示</li>
<li>提醒和推荐</li>
</ul>
<h2 id="为什么要用-Git？"><a href="#为什么要用-Git？" class="headerlink" title="为什么要用 Git？"></a>为什么要用 Git？</h2><ul>
<li>一个工具、一套方案，解决源码管理的问题</li>
</ul>
<h3 id="对于版本控制，我们需要什么？"><a href="#对于版本控制，我们需要什么？" class="headerlink" title="对于版本控制，我们需要什么？"></a>对于版本控制，我们需要什么？</h3><ul>
<li>代码历史追溯<ul>
<li>某一次提交的改动（SVN，Git）</li>
<li>某一个功能的改动过程（好的提交习惯更重要，在多人协作情况下提交历史更清晰）</li>
</ul>
</li>
<li>协同开发<ul>
<li>用分支来隔离上线与开发中的代码</li>
<li>多人多线并行开发：1 人对 N 线，N 人对 1 线都有可能</li>
</ul>
</li>
</ul>
<blockquote>
<p>秒极定律<br>一件事情如果能控制在 10s 内完成，人们就会极频繁的使用它。<br>举栗子：</p>
<ul>
<li>docker 被推崇，从虚拟机到 Vagrant 到 docker，碰到了秒级定律</li>
<li>持续集成，快速迭代</li>
</ul>
</blockquote>
<h3 id="秒级的代码管理？"><a href="#秒级的代码管理？" class="headerlink" title="秒级的代码管理？"></a>秒级的代码管理？</h3><ul>
<li>本地代码飞快变化至任意历史提交记录：SVN 30s-2min；Git 秒级<ul>
<li>工作状态快速切换</li>
</ul>
</li>
<li>代码提交速度飞快：SVN 受限于网络速度；Git commit 秒级，push 受限于网络速度</li>
<li>代码创建、切换、合并分支飞快：SVN 速度慢，很麻烦；Git 赞！<ul>
<li>勇于原型探索，历史清晰，易调整方向，易新建，易弃用</li>
<li>与 code review 结合</li>
</ul>
</li>
</ul>
<h2 id="SVN-比-Git-好在哪里"><a href="#SVN-比-Git-好在哪里" class="headerlink" title="SVN 比 Git 好在哪里"></a>SVN 比 Git 好在哪里</h2><ul>
<li>更简单，符合原有自主文件夹管理版本的心理预期<ul>
<li>Git 暴露概念过多，学习曲线陡峭，这点不如 hg</li>
</ul>
</li>
<li>SVN 有目录级的权限控制<ul>
<li>适合大中型中间件软件公司：目录划分权限，职能长期固定</li>
</ul>
</li>
<li>也许还有其它，我不清楚</li>
</ul>
<h3 id="Git-真实的影响力"><a href="#Git-真实的影响力" class="headerlink" title="Git 真实的影响力"></a>Git 真实的影响力</h3><blockquote>
<p>I’m an egotistical bastard, and I name all my projects after myself. First Linux, now Git.<br>—— Linus</p>
</blockquote>
<ul>
<li>在 2016 问这个问题对互联网来说已是大势所趋<ul>
<li>npm + pip 均托管在 Github</li>
<li>OpenJDK 使用 Hg（Mercurial）</li>
<li>Github 早已一统开源天下，Java 概莫能外</li>
</ul>
</li>
<li>SVN 与 Git 二分天下，但 Git 占据的是互联网明星创业公司和 BAT 的优秀团队，为何？</li>
<li>会 Git 找工作是加分项</li>
<li>学习版本控制的另一种思维方式（学习一门语言就是学习一类思维方式）</li>
</ul>
<h2 id="一些问题"><a href="#一些问题" class="headerlink" title="一些问题"></a>一些问题</h2><ul>
<li>Git 不能直接解决目前后端的开发环境<ul>
<li>code 规范的 branch 流程</li>
<li>依赖，理清 maven 依赖和配合方式</li>
<li>秒级上线（测试、预发布、正式）</li>
<li>相应（尽可能少人力介入的）自动化测试、监控</li>
</ul>
</li>
</ul>
<h2 id="Git-SourceTree-Gitlab-的使用演示"><a href="#Git-SourceTree-Gitlab-的使用演示" class="headerlink" title="Git + SourceTree + Gitlab 的使用演示"></a>Git + SourceTree + Gitlab 的使用演示</h2><p><img src="http://7j1xgb.com5.z0.glb.clouddn.com/FullSizeRender.jpg" alt="Git 使用流程示意图"></p>
<h3 id="local-repo"><a href="#local-repo" class="headerlink" title="local repo"></a>local repo</h3><ul>
<li>用 SourceTree 初始化一个本地项目</li>
<li>小步提交，介绍 staged 的用法<ul>
<li>stage or unstage or discard</li>
<li>stage 某一行代码</li>
</ul>
</li>
<li>一次提交</li>
<li>介绍 master 分支及 branchs 界面<ul>
<li>留意 commit 编号</li>
</ul>
</li>
<li>创建一个分支 feature/login</li>
<li>新建 login.java 文件，index.html 加一行代码</li>
<li>commit，观察分支树变化</li>
<li>切换分支，观察代码变化</li>
<li>创建一个分支 feature/share</li>
<li>新建 share.py 文件，index.html 改一行代码</li>
<li>commit，观察分支树变化</li>
<li>切回 feature/login，临时处理事情，再切回 feature/share</li>
<li>feature/share 分支删几行代码，再提交一次</li>
<li>feature/share merge to master 分支，观察分支树变化</li>
<li>feature/login merge to master 分支，处理冲突</li>
<li>初始化 Git-flow</li>
<li>新建 feature/school 分支，commit once</li>
<li>用 Git-flow-gui 完成 feature/school 分支</li>
<li>留意刚才的所有提交都在本地，思考与 SVN 区别（很像，只是分支极灵活）</li>
<li>Q&amp;A</li>
</ul>
<h3 id="Gitlab"><a href="#Gitlab" class="headerlink" title="Gitlab"></a>Gitlab</h3><ul>
<li>注册帐号，ssh-key 授权（略）</li>
<li>介绍 Gitlab 结构：team-project</li>
<li>新建项目 test-repo</li>
<li>留意空项目向导，复制代码库 url</li>
<li>本地配置 remote-url，观察 remotes 变化</li>
<li>push，注意是 push 多条分支，留意 local-remote 分支对应关系</li>
<li>再看 remotes 变化，分支树变化<ul>
<li>remotes branchs 与 local branchs 一致</li>
<li>分支树中多了 origin/*</li>
</ul>
</li>
<li>观察 Gitlab 界面变化</li>
<li>介绍 Gitlab 单个项目界面</li>
<li>Q&amp;A</li>
</ul>
<h3 id="来一次典型的开发过程（包含-code-review）"><a href="#来一次典型的开发过程（包含-code-review）" class="headerlink" title="来一次典型的开发过程（包含 code review）"></a>来一次典型的开发过程（包含 code review）</h3><ul>
<li>保证在 develop 分支，pull 最新代码</li>
<li>网页端提交 readme 文件，造成 origin 变化，介绍 fetch，注意 branchs 变化</li>
<li>重新 pull</li>
<li>用 Git-flow-gui 建立 feature/news 分支</li>
<li>产生两次 commit（包含 rename 文件）</li>
<li>留意分支树变化，注意 Gitlab-web 端不存在刚才的提交，push，再对比</li>
<li>Gitlab-web 端新建 merge-request, 留意 source-branch, target-branch, title, ass</li>
<li>被指派者 review 代码，web 端回复建议</li>
<li>根据建议产生新的 commit，同时 push</li>
<li>刷新 web 端观察变化：查看一次 commit，查看全部 changes</li>
<li>被指派者回复 LGTM（look good to me），点击 merge</li>
<li>回到 SourceTree，观察分支树变化，fetch 再看</li>
<li>切回 develop 分支</li>
<li>Q&amp;A<ul>
<li>有冲突 merge 按钮会不可点击，merge develop to work_branch ，在 develop 分支外解决冲突，commit&amp;push，merge 按钮就可点击了</li>
<li>可方便的与自动化测试等结合起来</li>
</ul>
</li>
</ul>
<h2 id="提醒和推荐"><a href="#提醒和推荐" class="headerlink" title="提醒和推荐"></a>提醒和推荐</h2><h2 id="一些提醒（坑）"><a href="#一些提醒（坑）" class="headerlink" title="一些提醒（坑）"></a>一些提醒（坑）</h2><ul>
<li>初次使用 Git，注意设置 <code>git config --global email&amp;name</code></li>
<li>Windows 下的 Git 使用的确有些不便（不过我不熟悉，也不清楚具体问题）</li>
<li>授权方式推荐 ssh-key</li>
<li>忽略文件的配置</li>
<li>着手代码前思考终极问题：『我在哪里，要去何处？』（先认清所在分支，pull）</li>
<li>commit 已经 push 到远端了，这个时候不要想着再去修改了</li>
<li>学习新东西，坑总是有的，多填了也就会了</li>
</ul>
<h3 id="一些推荐"><a href="#一些推荐" class="headerlink" title="一些推荐"></a>一些推荐</h3><ul>
<li>强调思路，记住秒级定律，效率为王</li>
<li>小步提交，每小时至少提交一次<ul>
<li>一次任务的实现过程：整体设计，框架（类），接口，单元测试，实现</li>
</ul>
</li>
<li>完整提交，完整提交，必须完整提交！不该有任一个提交项目不可运行。</li>
<li>保证非工作期间，工作区间干净</li>
<li>不想提交但要切换分支处理事物用 stash 处理</li>
<li>Github 经常被 X<ul>
<li>coding.net 代码私有库托管可以用。找开源代码，永远是 Github</li>
<li>Google 也是被 X。珍爱生命，自配 VPN</li>
</ul>
</li>
<li>国内 Git 私有库托管推荐 coding.net，国外推荐 bitbucket（支持hg） 和 Gitlab</li>
</ul>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><ul>
<li>依赖（迷信）工具不可取，但工具会影响思维方式，而思维方式非常重要</li>
</ul>
<blockquote>
<p>举例：<br>SVN 的思维方式决定了 diff patch 的开源合作方式。交流不顺畅，实现思路难以程现，这种合作方式很长时间里都是高端人士的特权。<br>Git + Github 催生了 fork，成就了最大的程序员社交网站，也极力促进了开源社区的发展。</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/移动组周分享/">移动组周分享</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-前端入门（2）" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/11/前端入门（2）/" class="article-date">
      <time datetime="2015-12-11T10:30:00.000Z" itemprop="datePublished">2015-12-11</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/11/前端入门（2）/">前端入门（2）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>###<a href="">博客地址</a></p>
<p>##Swift柯里化 Curring 学习</p>
<p>###什么是Curring</p>
<blockquote>
<p><a href="https://zh.wikipedia.org/wiki/%E6%9F%AF%E9%87%8C%E5%8C%96" target="_blank" rel="external">维基百科解释</a><br>在计算机科学中，柯里化（英语：Currying），又译为卡瑞化或加里化，是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术。</p>
</blockquote>
<p>概念看上去还是有点抽象，直接看代码</p>
<p><strong>例子</strong><br>注：所有swift代码都可以放到playgroun中运行查看输出<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="comment">// 一个普通求sum函数</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a: Int, b: Int, <span class="built_in">c</span>: Int)</span></span> -&gt; <span class="type">Int</span>&#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(a)</span> + <span class="subst">\(b)</span> + <span class="subst">\(<span class="built_in">c</span>)</span> = <span class="subst">\(a + b + <span class="built_in">c</span>)</span>"</span>)</div><div class="line">    <span class="keyword">return</span> a + b + <span class="built_in">c</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">add(<span class="number">1</span>, b: <span class="number">2</span>,<span class="built_in">c</span>: <span class="number">3</span>) <span class="comment">// 打印1 + 2 + 3 = 6</span></div><div class="line"></div><div class="line"><span class="comment">// 柯里化版本的求sum函数</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">addCur</span><span class="params">(a: Int)</span></span>(b: <span class="type">Int</span>)(<span class="built_in">c</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span>&#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(a)</span> + <span class="subst">\(b)</span> + <span class="subst">\(<span class="built_in">c</span>)</span> = <span class="subst">\(a + b + <span class="built_in">c</span>)</span>"</span>)</div><div class="line">    <span class="keyword">return</span> a + b + <span class="built_in">c</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">addCur(<span class="number">1</span>)(b: <span class="number">2</span>)(<span class="built_in">c</span>: <span class="number">3</span>) <span class="comment">// 打印1 + 2 + 3 = 6</span></div></pre></td></tr></table></figure></p>
<p>你也许觉得Curring只是用一个特殊的写法<br>其他与普通函数无异<br>那么换一种curring的调用方式</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// curring 另类调用方式</span></div><div class="line"><span class="keyword">let</span> funcWithA = addCur(<span class="number">1</span>)</div><div class="line"><span class="built_in">print</span>(<span class="string">"funcWithA type : <span class="subst">\(funcWithA.<span class="keyword">dynamicType</span>)</span>"</span>)</div><div class="line"><span class="keyword">let</span> funcWithAB = funcWithA(b: <span class="number">2</span>)</div><div class="line"><span class="built_in">print</span>(<span class="string">"funcWithAB type : <span class="subst">\(funcWithAB.<span class="keyword">dynamicType</span>)</span>"</span>)</div><div class="line"><span class="keyword">let</span> resultCurring = funcWithAB(<span class="built_in">c</span>: <span class="number">3</span>)</div><div class="line"><span class="built_in">print</span>(<span class="string">"resultCurring type : <span class="subst">\(resultCurring.<span class="keyword">dynamicType</span>)</span>"</span>)</div><div class="line">``` </div><div class="line"></div><div class="line">此时你还是会觉得这只是把一个函数拆开来调用了 那么我们打印一下 每个调用步骤中变量的类型</div></pre></td></tr></table></figure>
<p>let funcWithA = addCur(1)<br>print(“funcWithA type : (funcWithA.dynamicType)”) //<br>let funcWithAB = funcWithA(b: 2)<br>print(“funcWithAB type : (funcWithAB.dynamicType)”)<br>let resultCurring = funcWithAB(c: 3)<br>print(“resultCurring type : (resultCurring.dynamicType)”)<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">打印结果为</div></pre></td></tr></table></figure></p>
<p>1 + 2 + 3 = 6<br>funcWithA type : Int -&gt; Int -&gt; Int<br>funcWithAB type : Int -&gt; Int<br>1 + 2 + 3 = 6<br>resultCurring type : Int<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">可以看到 变量funcWithA 为 Int -&gt; Int -&gt; Int 类型</div><div class="line">funcWithAB 为Int -&gt; Int</div><div class="line"></div><div class="line">这说明 curring函数在绑定最后一个参数之前 每个步骤返回的值都是一个函数</div><div class="line"></div><div class="line"><span class="section">###Curring实现原理</span></div><div class="line"></div><div class="line">Swift实现Curring的基础有两个</div><div class="line"><span class="bullet">- </span>函数是一级公民</div><div class="line"><span class="bullet">- </span>闭包</div><div class="line"></div><div class="line">[<span class="string">啊崢的Swift Curring文章</span>](<span class="link">http://www.jianshu.com/p/6eaacadafa1a</span>)代码例子解释的已经很清楚了</div></pre></td></tr></table></figure></p>
<p>class Currying<br>{<br>    /<strong><em> uncurried:普通函数 </em></strong>/<br>    // 接收多个参数的函数<br>    func add(a: Int, b: Int, c: Int) -&gt; Int{<br>        println(“(a) + (b) + (c)”)<br>        return a + b + c<br>    }</p>
<pre><code>/*** 手动实现柯里化函数 ***/
// 把上面的函数转换为柯里化函数，首先转成接收第一个参数a，并且返回接收余下第一个参数b的新函数（采用闭包）
// 为了让大家都能看懂,我帮你们拆解来看下
// (a: Int) : 参数
// (b:Int) -&gt; (c: Int) -&gt; Int : 函数返回值（一个接收参数b的函数,并且这个函数又返回一个接收参数c,返回值为Int类型的函数)

// 定义一个接收参数a,并且返回一个接收参数b的函数,并且这个函数又返回一个接收参数c,返回值为Int类型的函数
func add(a: Int) -&gt; (b:Int) -&gt; (c: Int) -&gt; Int{

    // 一个接收参数b的函数,并且这个函数又返回一个接收参数c,返回值为Int类型的函数
    return { (b:Int) -&gt; (c: Int) -&gt; Int in

        // 返回一个接收余下第一个参数c，并且有返回结果为Int类型的函数
        return { (c: Int) -&gt; Int in

            return a + b + c;

 注解： 这里为什么能使用参数a,b,c?
       利用闭包的值捕获特性，即使这些值作用域不在了，也可以捕获到他们的值。
       闭包会自动判断捕获的值是值拷贝还是值引用，如果修改了，就是值引用，否则值拷贝。

       注意只有在闭包中才可以，a,b,c都在闭包中。

        }

    }

}


/*** curried: 系统自带的柯里化函数 ***/
func addCur(a: Int)(b: Int)(c: Int) -&gt; Int{
    println(&quot;\(a) + \(b) + \(c)&quot;)
    return a + b + c
}
</code></pre><p>}<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="section">###OC版的Curring</span></div><div class="line"></div><div class="line">大部分的iOS程序员都还是习惯写OC 找了一个[<span class="string">OC版本的Curring</span>](<span class="link">https://gist.github.com/lukhnos/1771842</span>)实现 我们可以理解的更深刻</div></pre></td></tr></table></figure></p>
<p>#include <stdio.h><br>int f(int x, int y)<br>{<br>    return x + y;<br>}</stdio.h></p>
<p>int main()<br>{<br>    // 闭包1 绑定第一个参数<br>    typedef int (^int_to_int_t)(int);<br>    // 闭包2 绑定第二个参数<br>    typedef int_to_int_t (^int_to_int_to_int_t)(int);</p>
<pre><code>int_to_int_to_int_t h = ^(int x) {
    int_to_int_t g = ^(int y) {
        // 将两个闭包持有的参数做处理 返回结果
        return f(x, y);  
    };

    return g;        
};

// 第一个闭包持有 5
int_to_int_t g = h(5);

int z;
// 第二个闭包持有10 并返回结果
z = g(10);
printf(&quot;%d\n&quot;, z);
</code></pre><p>}<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="section">###什么？你觉得然并卵！</span></div><div class="line"></div><div class="line">你一定觉得这是一个然并卵的东西</div><div class="line"></div><div class="line">好吧 我第一个看到的时候 只是觉得有趣 其实也没有想到较好的应用场景 </div><div class="line"></div><div class="line">[<span class="string">为什么要柯里化</span>](<span class="link">https://gist.github.com/jcouyang/b56a830cd55bd230049f</span>)这篇文章提供的例子给了很多启发</div><div class="line"></div><div class="line">用Swift重新实现了一遍 又加了一点打印 豁然开朗</div><div class="line"></div><div class="line">上代码</div></pre></td></tr></table></figure></p>
<p>// 拼接字符<br>func concat(chars: Array<string>) {<br>    var resultString = “”<br>    for char in chars {<br>        resultString += char<br>    }<br>    print(resultString)<br>}</string></p>
<p>concat([“1”,”2”,”3”])<br>print(“<strong><strong><strong>**</strong></strong></strong>“)</p>
<p>// 每个字符代表的数字 + 1 后再拼接<br>func concatAdd(chars: Array<string>, addNum: Int) {<br>    var resultString = “”<br>    for char in chars {<br>        var num = Int(char)!<br>        num = num + addNum<br>        let newChar = String(num)<br>        resultString += newChar<br>    }<br>    print(resultString)<br>}</string></p>
<p>concatAdd([“1”,”2”,”3”], addNum: 1)<br>concatAdd([“1”,”2”,”3”], addNum: 2)<br>concatAdd([“1”,”2”,”3”], addNum: 3)</p>
<p>print(“<strong><strong><strong>**</strong></strong></strong>“)<br>// 每个字符代表的数字 <em>10 后再拼接<br>func concatMultiply(chars: Array<string>, multiplyNum: Int) {<br>    var resultString = “”<br>    for char in chars {<br>        var num = Int(char)!<br>        num = num </string></em> multiplyNum<br>        let newChar = String(num)<br>        resultString += newChar<br>    }<br>    print(resultString)<br>}</p>
<p>concatMultiply([“1”,”2”,”3”], multiplyNum: 1)<br>concatMultiply([“1”,”2”,”3”], multiplyNum: 2)<br>concatMultiply([“1”,”2”,”3”], multiplyNum: 3)</p>
<p>print(“<strong><strong><strong>**</strong></strong></strong>“)<br>/<strong><strong><br>让我们使用柯里化吧<br>*</strong></strong>/<br>func add(a: Int)(b: Int) -&gt; Int{<br>    return a + b<br>}</p>
<p>func multiply(a: Int)(b: Int) -&gt; Int{<br>    return a * b<br>}</p>
<p>func concatByCurring(chars: Array<string>)(caculateFunc: (Int)-&gt;Int) {<br>    var resultString = “”<br>    for char in chars {<br>        var num = Int(char)!<br>        var newNum = caculateFunc(num)<br>        let newChar = String(newNum)<br>        resultString += newChar<br>    }<br>    print(resultString)<br>}</string></p>
<p>concatByCurring([“1”,”2”,”3”])(caculateFunc: add(1))<br>concatByCurring([“1”,”2”,”3”])(caculateFunc: add(2))<br>concatByCurring([“1”,”2”,”3”])(caculateFunc: add(3))</p>
<p>print(“<strong><strong><strong>**</strong></strong></strong>“)<br>concatByCurring([“1”,”2”,”3”])(caculateFunc: multiply(1))<br>concatByCurring([“1”,”2”,”3”])(caculateFunc: multiply(2))<br>concatByCurring([“1”,”2”,”3”])(caculateFunc: multiply(3))</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">以上的代码用普通的函数 和 Curring函数 处理了同一个功能</div><div class="line"></div><div class="line">Curring优势明显</div><div class="line"><span class="bullet">- </span>重用了拼接代码</div><div class="line"><span class="bullet">- </span>支持更为灵活的算法替换</div><div class="line"><span class="bullet">- </span>写功能扩展的人不用怎么关心老代码的实现</div><div class="line"></div><div class="line"><span class="section">###iOS开发中可以应用的场景</span></div><div class="line"></div><div class="line"><span class="strong">**使用Curring处理selector**</span></div><div class="line">这个例子是我在看[<span class="string">王巍的Swifter</span>](<span class="link">https://selfstore.io/~onevcat</span>)时候看到的一个例子</div><div class="line"></div><div class="line">不废话 直接上代码</div></pre></td></tr></table></figure>
<p>// 打印func类型<br>class People: NSObject {<br>    func speak(){<br>        print(“hello”)<br>    }</p>
<pre><code>func printSpeak() {
    print(&quot;People func speak  : \(People.speak.dynamicType)&quot;)
}
</code></pre><p>}</p>
<p>People().printSpeak()<br>// 打印结果为 People func speak  : People -&gt; () -&gt; ()<br>// 可见实例的方法就是一个Curring结构<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">下面是[<span class="string">Instance Methods are Curried Functions in Swift</span>](<span class="link">http://oleb.net/blog/2014/07/swift-instance-methods-curried-functions/?utm_campaign=iOS_Dev_Weekly_Issue_157&amp;utm_medium=email&amp;utm_source=iOS%2BDev%2BWeekly</span>)中的例子 很开脑洞</div></pre></td></tr></table></figure></p>
<p>//Selector demo<br>protocol TargetAction {<br>    func performAction()<br>}</p>
<p>struct TargetActionWrapper<t: anyobject=""> : TargetAction {<br>    weak var target: T?</t:></p>
<pre><code>// 此处的action类型是不是和我上面代码中打印的结构一致
let action: (T) -&gt; () -&gt; ()

func performAction() -&gt; () {
    if let t = target {
        // Curring调用
        action(t)()
    }
}
</code></pre><p>}</p>
<p>enum ControlEvent {<br>    case TouchUpInside<br>    case ValueChanged<br>}</p>
<p>class Control {<br>    var actions = <a href="">ControlEvent: TargetAction</a></p>
<pre><code>func setTarget&lt;T: AnyObject&gt;(target: T, action: (T) -&gt; () -&gt; (), controlEvent: ControlEvent) {
    actions[controlEvent] = TargetActionWrapper(target: target, action: action)
}

func removeTargetForControlEvent(controlEvent: ControlEvent) {
    actions[controlEvent] = nil
}

func performActionForControlEvent(controlEvent: ControlEvent) {
    actions[controlEvent]?.performAction()
}
</code></pre><p>}</p>
<p>class MyViewController {<br>    let button = Control()</p>
<pre><code>func viewDidLoad() {
    button.setTarget(self, action: MyViewController.onButtonTap, controlEvent: .TouchUpInside)
}

func onButtonTap() {
    print(&quot;Button was tapped&quot;)
}
</code></pre><p>}</p>
<p>// 调用<br>MyViewController().onButtonTap()<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="section">###小结</span></div><div class="line"><span class="bullet">- </span>Curring让计算过程更清晰 函数式编程的有点初见端倪</div><div class="line"><span class="bullet">- </span>Curring让计算过程更独立 可重用</div><div class="line"><span class="bullet">- </span>Curring让计算功能扩展更方便</div><div class="line"><span class="bullet">- </span>Curring让Swift中Selector的重构可以实现</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="section">## Umeng分享遇到的小坑 -- 张超耀</span></div><div class="line"><span class="section">### 写在前面的话</span></div><div class="line"><span class="bullet">- </span>在iOS9下，系统默认会拦截对http协议接口的访问，因此无法获取http协议接口的数据。对Umeng来说，具体表现可能是，无法授权、分享、获取用户信息等。</div><div class="line"><span class="bullet">- </span>iOS9新建项目默认需要支持bitcode，而不支持bitcode的SDK会导致无法编译运行。[<span class="string">App Thining</span>](<span class="link">https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/AppThinning/AppThinning.html#//apple_ref/doc/uid/TP40012582-CH35</span>)）</div><div class="line"></div><div class="line">[<span class="string">Umeng适配iOS9</span>](<span class="link">http://dev.umeng.com/social/ios/ios9</span>)</div><div class="line"></div><div class="line"><span class="section">### 针对iOS9的Https特性，解决方案</span></div><div class="line"><span class="bullet">- </span>Plan A: 暂时退回到http协议:</div><div class="line"></div><div class="line">&gt;<span class="strong">**1**</span>、在项目的info.plist中添加一个Key：NSAppTransportSecurity，类型为字典类型。</div><div class="line">&gt;<span class="strong">**2**</span>、然后给它添加一个Key：NSAllowsArbitraryLoads，类型为Boolean类型，值为YES；</div><div class="line"></div><div class="line"><span class="bullet">- </span>Plan B：设置域。可以简单理解成，把不支持https协议的接口设置成http的接口</div><div class="line"></div><div class="line"></div><div class="line">&gt;<span class="strong">**1**</span>、在项目的info.plist中添加一个Key：NSAppTransportSecurity，类型为字典类型。</div><div class="line"></div><div class="line">&gt;<span class="strong">**2**</span>、然后给它添加一个NSExceptionDomains，类型为字典类型；</div><div class="line"></div><div class="line">&gt;<span class="strong">**3**</span>、把需要的支持的域添加給NSExceptionDomains。其中域作为Key，类型为字典类型。</div><div class="line"></div><div class="line">&gt;<span class="strong">**4**</span>、每个域下面需要设置3个属性：NSIncludesSubdomains、		NSExceptionRequiresForwardSecrecy、		NSExceptionAllowsInsecureHTTPLoads。</div><div class="line"><span class="code">	均为Boolean类型，值分别为YES、NO、YES。</span></div><div class="line"><span class="code">	</span></div><div class="line"><span class="section">### 针对App Thinning</span></div><div class="line"></div><div class="line"><span class="section">### 添加Scheme白名单实现应用跳转（SSO等）</span></div><div class="line"><span class="bullet">- </span>问题描述：在iOS 9下涉及到平台客户端跳转，系统会自动到项目info.plist下检测是否设置平台Scheme。对于需要配置的平台，如果没有配置，就无法正常跳转平台客户端。因此要支持客户端的分享和授权等，需要配置Scheme名单。</div><div class="line"><span class="bullet">- </span>解决方案：</div><div class="line"></div><div class="line">具体方法：</div><div class="line">&gt;1、在项目的info.plist中添加一LSApplicationQueriesSchemes，类型为Array。</div><div class="line"></div><div class="line">&gt;2、然后给它添加一个需要支持的项目，类型为字符串类型</div><div class="line"></div><div class="line"></div><div class="line"><span class="section">### 注意</span></div><div class="line"><span class="bullet">- </span>由于苹果审核政策需求，需要对未安装客户端平台进行隐藏，在设置QQ、微信AppID之后调用下面的方法，</div></pre></td></tr></table></figure></p>
<p>[UMSocialConfig hiddenNotInstallPlatforms:@[UMShareToQQ, UMShareToQzone, UMShareToWechatSession, UMShareToWechatTimeline]];</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"> - but  这个接口只对默认分享面板平台有隐藏功能，自定义分享面板或登录按钮需要自己处理</div><div class="line"> </div><div class="line">- 对于自定义分享面板处理：</div><div class="line">	- UmengSDK已经嵌入相关API，直接用就好</div><div class="line"></div><div class="line">### 只要按照官方文档来，基本上就能马到成功（）</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">##MarkDown 的 CSS 实现配置 - 杨志平</div><div class="line"></div><div class="line">####题目灵感来源</div><div class="line">&gt; 起源于我们现有的博客引擎主题交互很不错，但是排版烂的要死 ，我水平有限这里只是浅显介绍实现修改我们的markdown编译器的一些排版样式</div><div class="line"></div><div class="line">#### 研究方向</div><div class="line">&gt; 自定义一个非标准化，有其他多元素的MarkDown解析器 如下几点:</div><div class="line"></div><div class="line">-  可选框</div><div class="line"> `- [ ] `</div><div class="line">- 本地图片索引，可控制对齐及大小 </div><div class="line">`![Alt text](http:<span class="comment">//path/to/img.jpg "optional title" 100x200)`</span></div><div class="line">`![Alt text](./<span class="number">1449756974449.</span>png)`</div><div class="line">- 标签功能</div><div class="line">`@(Share)[css, Markdown]`</div><div class="line">- 代码高亮（不同语言）</div><div class="line"></div><div class="line">`swift`</div><div class="line"></div><div class="line">``` swift</div><div class="line">    private var majorModel = PickMajorModel()</div><div class="line">    private var subjectModel = OFFKeyNameModel()</div><div class="line">    required init?(coder aDecoder: NSCoder) &#123;</div><div class="line">        super.init(coder: aDecoder)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><code>objectivec</code></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIScrollView</span> *scrollView = [[<span class="built_in">UIScrollView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, kScreenW, kScreenH)];</div><div class="line">scrollView.showsVerticalScrollIndicator = <span class="literal">NO</span>;</div><div class="line">[scrollView addSubview:<span class="keyword">self</span>.downMainView];</div></pre></td></tr></table></figure>
<p><strong>有一种惨不忍睹的即视感</strong><br><img src="./1449756974449.png" alt="Alt text"></p>
<h3 id="MarkDown来源及实现"><a href="#MarkDown来源及实现" class="headerlink" title="MarkDown来源及实现"></a>MarkDown来源及实现</h3><blockquote>
<p>Markdown is a plain text format for writing structured documents, based on conventions used for indicating formatting in email and usenet posts. It was developed in 2004 by John Gruber, who wrote the first markdown-to-html converter in Perl, and it soon became widely used in websites. By 2014 there were dozens of implementations in many languages.</p>
</blockquote>
<p><code>见知乎上回答</code><br><a href="http://www.zhihu.com/question/28756456" target="_blank" rel="external">实现一个markdown解析器需要具备那些知识</a></p>
<p>###如何简单的改善文字编排的效果</p>
<h5 id="更换博客主题（简单粗暴）"><a href="#更换博客主题（简单粗暴）" class="headerlink" title="更换博客主题（简单粗暴）"></a>更换博客主题（简单粗暴）</h5><blockquote>
<p>我们使用的博客引擎Hexo来举例，列举下面三个主题</p>
<ul>
<li>landscape</li>
<li>hexo-theme-vno-master</li>
<li>hexo-theme-yilia-master</li>
</ul>
</blockquote>
<h5 id="更换MarkDown编译器的主题"><a href="#更换MarkDown编译器的主题" class="headerlink" title="更换MarkDown编译器的主题"></a>更换MarkDown编译器的主题</h5><blockquote>
<p>以 <strong><em>Mou</em></strong> 举例子，它提供了多套markdown语法下的排版样式<br>手动新创建一个CSS文本布局配置 <strong><em>Blog</em></strong><br><img src="./1449768288128.png" alt="Alt text"></p>
</blockquote>
<h4 id="CSS配置文件修改"><a href="#CSS配置文件修改" class="headerlink" title="CSS配置文件修改"></a>CSS配置文件修改</h4><p>详细配置参数如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">62.5%</span>; &#125;</div><div class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span> &#123; <span class="attribute">height</span>: <span class="number">100%</span>; &#125;</div><div class="line"></div><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">  <span class="attribute">font-family</span>: Helvetica, Arial, sans-serif;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">150%</span>;</div><div class="line">  <span class="attribute">line-height</span>: <span class="number">1.3</span>;</div><div class="line">  <span class="attribute">color</span>: <span class="number">#f6e6cc</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">700px</span>;</div><div class="line">  <span class="attribute">margin</span>: auto;</div><div class="line">  <span class="attribute">background</span>: <span class="number">#27221a</span>;</div><div class="line">  <span class="attribute">position</span>: relative;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>多级标题配置</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">h1</span> &#123;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">28px</span>;</div><div class="line">  <span class="attribute">color</span>: black; &#125;</div><div class="line"></div><div class="line"><span class="selector-tag">h2</span> &#123;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">24px</span>;</div><div class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#cccccc</span>;</div><div class="line">  <span class="attribute">color</span>: black; &#125;</div><div class="line"></div><div class="line"><span class="selector-tag">h3</span> &#123;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">18px</span>; &#125;</div><div class="line"></div><div class="line"><span class="selector-tag">h4</span> &#123;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>; &#125;</div><div class="line"></div><div class="line"><span class="selector-tag">h5</span> &#123;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>; &#125;</div><div class="line"></div><div class="line"><span class="selector-tag">h6</span> &#123;</div><div class="line">  <span class="attribute">color</span>: <span class="number">#777777</span>;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>; &#125;</div></pre></td></tr></table></figure>
<p>表格</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">table</span> &#123;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;<span class="attribute">border-collapse</span>: collapse; &#125;</div><div class="line">  <span class="selector-tag">table</span> <span class="selector-tag">tr</span> &#123;</div><div class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#cccccc</span>;</div><div class="line">    <span class="attribute">background-color</span>: white;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">padding</span>: <span class="number">0</span>; &#125;</div><div class="line">    <span class="selector-tag">table</span> <span class="selector-tag">tr</span>:nth-child(<span class="number">2</span>n) &#123;</div><div class="line">      <span class="attribute">background-color</span>: <span class="number">#f8f8f8</span>; &#125;</div><div class="line">    <span class="selector-tag">table</span> <span class="selector-tag">tr</span> <span class="selector-tag">th</span> &#123;</div><div class="line">      <span class="attribute">font-weight</span>: bold;</div><div class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#cccccc</span>;</div><div class="line">      <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">      <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">13px</span>; &#125;</div><div class="line">    <span class="selector-tag">table</span> <span class="selector-tag">tr</span> <span class="selector-tag">td</span> &#123;</div><div class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#cccccc</span>;</div><div class="line">      <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">      <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">13px</span>; &#125;</div><div class="line">    <span class="selector-tag">table</span> <span class="selector-tag">tr</span> <span class="selector-tag">th</span> :first-child, <span class="selector-tag">table</span> <span class="selector-tag">tr</span> <span class="selector-tag">td</span> :first-child &#123;</div><div class="line">      <span class="attribute">margin-top</span>: <span class="number">0</span>; &#125;</div><div class="line">    <span class="selector-tag">table</span> <span class="selector-tag">tr</span> <span class="selector-tag">th</span> :last-child, <span class="selector-tag">table</span> <span class="selector-tag">tr</span> <span class="selector-tag">td</span> :last-child &#123;</div><div class="line">      <span class="attribute">margin-bottom</span>: <span class="number">0</span>; &#125;</div></pre></td></tr></table></figure>
<p>代码高亮</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">code</span>, <span class="selector-tag">tt</span> &#123;</div><div class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">2px</span>;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">5px</span>;</div><div class="line">  <span class="attribute">white-space</span>: nowrap;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#eaeaea</span>;</div><div class="line">  <span class="attribute">background-color</span>: <span class="number">#f8f8f8</span>;</div><div class="line">  <span class="attribute">border-radius</span>: <span class="number">3px</span>; &#125;</div><div class="line"></div><div class="line"> <span class="selector-tag">code</span> &#123;</div><div class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="attribute">border</span>: none;</div><div class="line">  <span class="attribute">background</span>: transparent; &#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/移动组周分享/">移动组周分享</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-前端入门（1）" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/02/前端入门（1）/" class="article-date">
      <time datetime="2015-12-02T10:30:00.000Z" itemprop="datePublished">2015-12-02</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/02/前端入门（1）/">前端入门（1）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Ruby-on-Rails-初体验-王胜"><a href="#Ruby-on-Rails-初体验-王胜" class="headerlink" title="Ruby on Rails 初体验 - 王胜"></a>Ruby on Rails 初体验 - 王胜</h2><h3 id="使用命令行快速创建应用的步骤"><a href="#使用命令行快速创建应用的步骤" class="headerlink" title="使用命令行快速创建应用的步骤"></a>使用命令行快速创建应用的步骤</h3><ul>
<li><p>创建应用程序</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash">rails new hello <span class="_">-d</span> mysql</span></div></pre></td></tr></table></figure>
<p><strong>备注</strong> 这里演示使用mysql作为数据持久层</p>
</li>
<li><p>浏览hello world界面</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"><span class="built_in">cd</span> hello</span></div><div class="line"><span class="meta">$</span><span class="bash">rake db:create RAILS_ENV=<span class="string">'development'</span> // 创建开发数据库</span></div><div class="line"><span class="meta">$</span><span class="bash">bin/rails server</span></div></pre></td></tr></table></figure>
<p><strong>备注</strong> 由于这里的rails版本是4.2.1，与msqyl2的最高版本有不兼容行，所以需要手动将Gemfile中mysql2降级。降级之后执行bundle install。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem <span class="string">'mysql2'</span> -&gt; gem <span class="string">'mysql2'</span>, <span class="string">'~&gt; 0.3.18'</span></div></pre></td></tr></table></figure>
</li>
<li><p>使用脚手架，创建模型、数据迁移脚本以及控制器和试图</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash">bin/rails generate scaffold Person name:string age:<span class="built_in">integer</span></span></div></pre></td></tr></table></figure>
</li>
<li><p>执行数据迁移</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash">bin/rake db:migrate RAILS_ENV=development</span></div></pre></td></tr></table></figure>
</li>
<li><p>启动应用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash">bin/rails server</span></div></pre></td></tr></table></figure>
</li>
<li><p>浏览效果</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">http:</span><span class="comment">//localhost:3000/people</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>备注</strong></p>
<p>此演示项目，ruby、gems和Rails的版本信息如下:</p>
<ul>
<li>ruby: 2.0.0p481</li>
<li>rubygems: 2.4.5</li>
<li>rails: 4.2.1</li>
</ul>
<p>参考：</p>
<ul>
<li><a href="http://guides.rubyonrails.org/command_line.html" target="_blank" rel="external">rubyonrails.org</a></li>
</ul>
<h2 id="Express-for-Node-js-上手演示-曾铭-（先占坑）"><a href="#Express-for-Node-js-上手演示-曾铭-（先占坑）" class="headerlink" title="Express for Node.js 上手演示 - 曾铭 （先占坑）"></a>Express for Node.js 上手演示 - 曾铭 （先占坑）</h2><h2 id="矢量图在Android-上应用-王进"><a href="#矢量图在Android-上应用-王进" class="headerlink" title="矢量图在Android 上应用 - 王进"></a>矢量图在Android 上应用 - 王进</h2><p>###VectorDrawable<br>示例：<br><figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></span></div><div class="line"><span class="tag">&lt;<span class="name">vector</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">        &lt;!<span class="attr">--</span>  <span class="attr">intrinsic</span>  <span class="attr">size</span>  <span class="attr">of</span>  <span class="attr">the</span>  <span class="attr">drawable</span>  <span class="attr">--</span>&gt;</div><div class="line">        android:height="300dp"</div><div class="line">        android:width="300dp"</div><div class="line">        <span class="comment">&lt;!-- size of the virtual canvas --&gt;</span></div><div class="line">        android:viewportHeight="40"</div><div class="line">        android:viewportWidth="40"</div><div class="line">        &gt;</div><div class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">android:fillColor</span>=<span class="string">"#ff00ff"</span></span></div><div class="line">                <span class="attr">android:pathData</span>=<span class="string">"M20.5,9.5</span></div><div class="line">                        c-1.955,0,-3.83,1.268,-4.5,3</div><div class="line">                        c-0.67,-1.732,-2.547,-3,-4.5,-3</div><div class="line">                        C8.957,9.5,7,11.432,7,14</div><div class="line">                        c0,3.53,3.793,6.257,9,11.5</div><div class="line">                        c5.207,-5.242,9,-7.97,9,-11.5</div><div class="line">                        C25,11.432,23.043,9.5,20.5,9.5z"</div><div class="line">                /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">vector</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>###SVG→Vector<br>Android并不原生支持读取常见的向量文件格式，如ＳＶＧ<br>（主要是缺少ｃｓｓ支持），但是支持相同路径数据语法，<br>所以ＳＶＧ资源需要经过一定的转换；</p>
<p>###使用SVG Path Data </p>
<ul>
<li>M： move to 移动绘制点</li>
<li>L：line to 直线</li>
<li>Z：close 闭合</li>
<li>C：cubic bezier 三次贝塞尔曲线</li>
<li>Q：quatratic bezier 二次贝塞尔曲线</li>
<li>A：ellipse 圆弧</li>
</ul>
<blockquote>
<p>每个命令都有大小写形式，大写代表后面的参数是绝对坐标，小写表示相对坐标。参数之间用空格或逗号隔开</p>
</blockquote>
<p><strong>命令详解：</strong></p>
<ul>
<li>M (x y) 移动到x,y</li>
<li>L (x y) 直线连到x,y，还有简化命令H(x) 水平连接、V(y)垂直连接</li>
<li>Z，没有参数，连接起点和终点</li>
<li>C(x1 y1 x2 y2 x y)，控制点x1,y1 x2,y2，终点x,y</li>
<li>Q(x1 y1 x y)，控制点x1,y1，终点x,y</li>
<li>A(rx ry x-axis-rotation large-arc-flag sweep-flag x y) <ul>
<li>rx ry 椭圆半径 </li>
<li>x-axis-rotation x轴旋转角度 </li>
<li>large-arc-flag 为0时表示取小弧度，1时取大弧度 </li>
<li>sweep-flag 0取逆时针方向，1取顺时针方向<br><img src="http://static.oschina.net/uploads/img/201510/01095231_IR6O.svg" alt=""></li>
</ul>
</li>
</ul>
<p>详细参考：<a href="http://www.w3.org/TR/SVG11/paths.html#PathData" target="_blank" rel="external">http://www.w3.org/TR/SVG11/paths.html#PathData</a></p>
<p>###Icon Font<br>解决矢量图低版本不兼容问题</p>
<p>详细参考：<br>1,<a href="http://blog.csdn.net/a345017062/article/details/46455745" target="_blank" rel="external">http://blog.csdn.net/a345017062/article/details/46455745</a><br>2,<a href="http://blog.csdn.net/goodlixueyong/article/details/41448483" target="_blank" rel="external">http://blog.csdn.net/goodlixueyong/article/details/41448483</a></p>
<h2 id="WordPress快速建站-–杨俊构"><a href="#WordPress快速建站-–杨俊构" class="headerlink" title="WordPress快速建站 –杨俊构"></a>WordPress快速建站 –杨俊构</h2><h3 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h3><ul>
<li><p>服务器php套件（ Nginx+PHP7.0）： <a href="http://www.upupw.net/" target="_blank" rel="external">UPUPW绿色服务器</a></p>
</li>
<li><p>WordPress代码包：<a href="https://cn.wordpress.org/" target="_blank" rel="external">wordpress-4.3.1-zh_CN</a></p>
</li>
</ul>
<h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><ul>
<li><p>配置服务器和数据库</p>
<ol>
<li>解压UPUPW_NP7.0-1511.7z 到本地目录</li>
<li>打开解压包后的upupw.exe配置平台。<br><img src="http://7xohph.com1.z0.glb.clouddn.com/05120101.jpg" alt=""></li>
<li>输入“S1”开启全部服务</li>
<li>打开地址 <a href="http://127.0.0.1/" target="_blank" rel="external">http://127.0.0.1/</a> 会看到UPUPWPHP探针页面<br><img src="http://7xohph.com1.z0.glb.clouddn.com/05120103.jpg" alt=""></li>
<li>打开地址 <a href="http://127.0.0.1/pmd/" target="_blank" rel="external">http://127.0.0.1/pmd/</a> 配置mysql数据库（默认用户名密码都是root）</li>
<li>新建数据库，用户名，密码</li>
<li>打开地址 <a href="http://127.0.0.1/" target="_blank" rel="external">http://127.0.0.1/</a> 使用数据库连接测试连接数据库是否正常</li>
</ol>
</li>
<li><p>安装配置wordpress</p>
<ol>
<li>解压wordpress-4.3.1-zh_CN.zip压缩包</li>
<li>将wordpress文件夹拷贝到UPUPW发布根目录/htdocs文件夹下</li>
<li>打来地址<a href="http://127.0.0.1/wordpress，根据开始安装" target="_blank" rel="external">http://127.0.0.1/wordpress，根据开始安装</a></li>
<li>输入刚才配置的数据库名，用户名，密码，点击提交进行</li>
<li>设置站点标题，后台登陆用户名，后台密码，邮件地址完成安装</li>
<li>再次打开地址<a href="http://127.0.0.1/wordpress测试安装完成" target="_blank" rel="external">http://127.0.0.1/wordpress测试安装完成</a><br><img src="http://7xohph.com1.z0.glb.clouddn.com/05120105.jpg" alt=""></li>
</ol>
</li>
</ul>
<h3 id="WordPress相关资源"><a href="#WordPress相关资源" class="headerlink" title="WordPress相关资源"></a>WordPress相关资源</h3><ul>
<li><p>推荐主题 ：<a href="http://www.weisay.com/blog/" target="_blank" rel="external">威言威语</a>     <a href="http://www.prower.cn/" target="_blank" rel="external">prower</a></p>
</li>
<li><p>推荐插件 ： <a href="http://duoshuo.com/" target="_blank" rel="external">多说</a> （评论快速提交，文章聚合发布）   <a href="http://developer.qiniu.com/download/index.html" target="_blank" rel="external">七牛镜像存储wordpress 插件</a>     <a href="http://www.youpzt.com/267.html" target="_blank" rel="external">youpzt-optimizer</a>（网站优化工具）</p>
</li>
<li><p><a href="http://www.oschina.net/news/55174/nextapp-opensource" target="_blank" rel="external">NextApp</a> —— 开源的WordPress手机博客 App 自动生成系统</p>
</li>
</ul>
<h2 id="spring-aop-简单介绍"><a href="#spring-aop-简单介绍" class="headerlink" title="spring aop 简单介绍"></a>spring aop 简单介绍</h2><h2 id="51offer-Android重构之Architecture-xpleemoon"><a href="#51offer-Android重构之Architecture-xpleemoon" class="headerlink" title="51offer Android重构之Architecture - xpleemoon"></a>51offer Android重构之Architecture - xpleemoon</h2><h3 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h3><ul>
<li>我们的app经历了一次重构，在重构过程中将IDE切换到Android Studio，并且编译脚本从Ant切换到了Gradle。</li>
<li>不介绍IDE和Gradle的优势，主要介绍重构后app的Architecture相关部分。</li>
</ul>
<blockquote>
<p>从0到1是一个开始，再从1到N又是另一个开始。</p>
</blockquote>
<h3 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h3><ul>
<li>当前我们的结构主要为4层：<ol>
<li>app</li>
<li>core</li>
<li>lib</li>
<li>model</li>
</ol>
</li>
</ul>
<p><img src="http://7xohph.com1.z0.glb.clouddn.com/X3.jpg" alt="project结构"></p>
<ul>
<li>app依赖core，而core依赖lib和model。随着以后的业务发展、产品迭代或者有更好的结构划分，会再做调整。</li>
</ul>
<p><img src="http://7xohph.com1.z0.glb.clouddn.com/X1.jpg" alt="module依赖"></p>
<h3 id="app——展现层（presention）"><a href="#app——展现层（presention）" class="headerlink" title="app——展现层（presention）"></a>app——展现层（presention）</h3><ul>
<li>用于页面展现，主要包含MVP模式中的VP。我们对V采用接口的方式去定义，然后让Activity或者Fragment去实现V接口，这样我们就达到接口编程的目的，P只需要关注V接口即可。以注册中的地区列表页面为例</li>
</ul>
<p><img src="http://7xohph.com1.z0.glb.clouddn.com/X4.jpg" alt="VP"></p>
<ul>
<li>V</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 地区view，MVP－V</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IRegionView</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 搜索更新</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">search2Update</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>P</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 国家地区，MVP－P</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegionPresenter</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;Region&gt; mRegions = OFRRegionHelper.getRegions();</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取地区列表</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;Region&gt; <span class="title">getRegions</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mRegions;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 搜索</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> regionView</div><div class="line">     * <span class="doctag">@param</span> searchRegion</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">search</span><span class="params">(@NonNull IRegionView regionView, String searchRegion)</span> </span>&#123;</div><div class="line">        mRegions.clear();</div><div class="line">        <span class="keyword">if</span> (TextUtils.isEmpty(searchRegion)) &#123;</div><div class="line">            mRegions.addAll(OFRRegionHelper.getRegions());</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            mRegions.addAll(OFRRegionHelper.searchRegions(searchRegion));</div><div class="line">        &#125;</div><div class="line">        regionView.search2Update();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>另外，我们的app有太多的业务逻辑，所以我们也使用了比较多的策略模式，方便以后的扩展和维护。比如不同的国家，它在意向单展现时就有不同的表现：<ul>
<li>可以同时选择的最多意向单数量</li>
<li>每个学校可以同时选择的最多专业数量 </li>
<li>意向单名字</li>
</ul>
</li>
<li>于是，我们就对此采用了策略模式</li>
</ul>
<p><img src="http://7xohph.com1.z0.glb.clouddn.com/X2.jpg" alt="国家意向单策略图"></p>
<ul>
<li>国家意向单策略接口</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 国家策略</div><div class="line"> * &lt;ul&gt;</div><div class="line"> * &lt;li&gt;不同国家可选的意向单数量不同，具体见&#123;<span class="doctag">@link</span> #maxCount2Select()&#125;&lt;/li&gt;</div><div class="line"> * &lt;li&gt;不同国家的学校专业可选数量不同，具体见&#123;<span class="doctag">@link</span> #maxCountOfPerSchool2Select()&#125;&lt;/li&gt;</div><div class="line"> * &lt;/ul&gt;</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ICountryPurpose</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 国家可以同时选择的最多意向单数量</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxCount2Select</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 每个学校可以同时选择的最多专业数量</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxCountOfPerSchool2Select</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 意向单名字，目前可用名字为：</div><div class="line">     * &lt;ol&gt;</div><div class="line">     * &lt;li&gt;专业&lt;/li&gt;</div><div class="line">     * &lt;li&gt;入学时间，当前只限日本&lt;/&gt;</div><div class="line">     * &lt;/ol&gt;</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> ctx</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function">String <span class="title">getName</span><span class="params">(@NonNull Context ctx)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="core"><a href="#core" class="headerlink" title="core"></a>core</h3><ul>
<li>核心层，主要用于应用相关的URL拼接、图片加载、网络请求、json解析、第三方平台、配置和工具。</li>
</ul>
<h3 id="lib"><a href="#lib" class="headerlink" title="lib"></a>lib</h3><ul>
<li>通用库层，不依赖于应用的任何业务，方便快速的移植到其它项目.</li>
</ul>
<h3 id="model"><a href="#model" class="headerlink" title="model"></a>model</h3><ul>
<li>数据层，作为MVP的M，用于应用的数据模型.</li>
</ul>
<h2 id="简单HTML5-吴明"><a href="#简单HTML5-吴明" class="headerlink" title="简单HTML5 吴明"></a>简单HTML5 吴明</h2><ul>
<li><a href="http://www.17sucai.com/pins/demoshow/4583" target="_blank" rel="external">烟火效果</a></li>
<li><a href="http://www.html5tricks.com/demo/html5-css3-404-animation/index.html" target="_blank" rel="external">404动画</a></li>
<li><a href="http://keleyi.com/keleyi/phtml/html5/31.htm" target="_blank" rel="external">爱心树</a></li>
<li>开发ide storm</li>
<li>目录结构<ul>
<li>dist:第三库存放地方，以下为存放指定文件类型目录<ul>
<li>css</li>
<li>js</li>
<li>doc</li>
<li>img</li>
</ul>
</li>
<li>src:项目指定文件类型目录<ul>
<li>css</li>
<li>js</li>
<li>doc</li>
<li>img  </li>
</ul>
</li>
</ul>
</li>
<li>简单代码</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--html5网页声明--&gt;</span></div><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>mobile<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 此处还可以插入其他meta,样式单等信息--&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--页面部分--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>现实是残酷的,别做梦,从hello word开始吧!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span>&gt;</span>不支持html5<span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="handlebars"><span class="xml"></span></span></div><div class="line">    <span class="comment">&lt;!-- 获取内容中id为canvas的元素--&gt;</span></div><div class="line">    var canvas = document.getElementById('canvas');</div><div class="line">//    获取canvas的环境,</div><div class="line">    var ctx = canvas.getContext('2d');</div><div class="line">//      填充的样式为红色</div><div class="line">    ctx.fillStyle = '#ff0000';</div><div class="line">    ctx.st//    画一个矩形,位置x,y,w,h</div><div class="line">    ctx.fillRect(0, 0, 600, 100);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>参考链接<ul>
<li><a href="http://caniuse.com/" target="_blank" rel="external">链接一</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML" target="_blank" rel="external">链接二</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/移动组周分享/">移动组周分享</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 Wilson
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>